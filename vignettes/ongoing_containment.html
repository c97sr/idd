<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Steven Riley" />


<title>Ongoing containment as a policy objective</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Ongoing containment as a policy
objective</h1>
<h4 class="author">Steven Riley</h4>
<h4 class="date">late 2023</h4>



<div id="background" class="section level2">
<h2>Background</h2>
<p>This analysis was initially developed between mid-February and early
morning of March 10th 2020. It was used during February to give early
estimates of the possible impact of school closures then updated to
describe what failed mitigation would look like. The original form of
the script used for the paper on ongoing containment is presevered in
the R file.</p>
<p>Next steps</p>
<ul>
<li>add the processed excess mortality as a data object to the
package</li>
</ul>
</div>
<div id="load-functions-and-population-data" class="section level2">
<h2>Load functions and population data</h2>
<p>First clear memory</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>(<span class="at">all=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<p>Load functions to run the hybrid model from local packages, from
github or directly from local copies if that is how the code has been
distributed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## source(&quot;~/git/idd/R/cov_hybrid.r&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">## library(devtools)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.4.1</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<p>Install SRâ€™s idd package either from github or locally</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## install_github(&quot;c97sr/idd&quot;)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="do">## devtools::uninstall()</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="do">## devtools::load_all()</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="do">## library(&quot;idd&quot;)</span></span></code></pre></div>
<p>Setup a population of size 66 million with a small timestep, and
assume that there were 6000 infectious individuals at time 0. There are
four groups in the model which would normally represent age groups.
However, they are all assumed to be eqactly equal.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="dv">66000000</span><span class="sc">*</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">6000</span><span class="sc">/</span><span class="fu">length</span>(pop),<span class="fu">length</span>(pop))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>xvals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">540</span>,dt)</span></code></pre></div>
<p>Make an initial run for 2 years with an R0 of 2.0 in a UK-like
population, with a trickle seed of 10 cases per week and nop reactive
behaviour change.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">1.4</span>,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">0.95</span>,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">99999999</span>,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span></code></pre></div>
<p>Then run with a reactive drop when the virus is known to be
present</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">1.4</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">0.95</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">5</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">FALSE</span>,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span></code></pre></div>
<p>Then run with a reactive drop when the virus is known to be
present</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">0.95</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">0.95</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">5</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">FALSE</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span></code></pre></div>
<p>Then run with a reactive drop when the virus is known to be
present</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">1.4</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">0.99</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">5</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span></code></pre></div>
<p>Then run with a reactive drop when the virus is known to be
present</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>y4A <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">1.4</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">0.99</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">5</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">2</span><span class="sc">*</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">TRUE</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>y4B <span class="ot">&lt;-</span> idd<span class="sc">::</span><span class="fu">cov_hybrid</span>(</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">2.0</span>,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    <span class="at">vecN=</span>pop,</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    <span class="at">vecI0=</span>seed,</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>    <span class="at">Rp=</span><span class="fl">1.4</span>,</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>    <span class="at">Rover=</span><span class="fl">1.1</span>,</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>    <span class="at">trig_pres=</span><span class="dv">5</span>,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>    <span class="at">icu_cap=</span><span class="dv">4357</span><span class="sc">/</span><span class="dv">53000000</span>,</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>    <span class="at">sevBchange=</span><span class="cn">TRUE</span>,</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>    <span class="at">vecPS=</span><span class="fu">rep</span>(<span class="fl">0.05</span>,<span class="fu">length</span>(pop)),</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>    <span class="at">trickle=</span><span class="dv">10</span>,</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>    <span class="at">vecTcalc=</span>xvals)</span></code></pre></div>
<p>Plot the baselines</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;y&quot;</span>)) {</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="fu">plot</span>(y1<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y1<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>         <span class="at">log=</span>s,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;Month&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Daily incidence (+1)&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    <span class="fu">points</span>(y2<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y2<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    <span class="fu">points</span>(y3<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y3<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    <span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y4<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;cyan&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot the sensitvities</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;y&quot;</span>)) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="fu">plot</span>(y1<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y1<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>         <span class="at">log=</span>s,<span class="at">col=</span><span class="st">&quot;gray&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;Month&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Daily incidence (+1)&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="fu">points</span>(y2<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y2<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;gray&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="fu">points</span>(y3<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y3<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;gray&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    <span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y4<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;gray&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="fu">points</span>(y4A<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y4A<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="fu">points</span>(y4B<span class="sc">$</span>t<span class="sc">/</span><span class="dv">30</span>,<span class="fu">rowSums</span>(y4B<span class="sc">$</span>inf[,,<span class="dv">1</span>]<span class="sc">/</span>dt<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Define a function to then output the total amount of infection</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>tabdisp <span class="ot">&lt;-</span> <span class="cf">function</span>(x)(<span class="fu">formatC</span>(<span class="fu">signif</span>(x,<span class="dv">3</span>), <span class="at">format=</span><span class="st">&quot;f&quot;</span>, <span class="at">big.mark=</span><span class="st">&quot;,&quot;</span>, <span class="at">digits=</span><span class="dv">0</span>))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y1<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;53,200,000&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y2<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;34,900,000&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y3<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;274,000&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y4<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;9,170,000&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y4A<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;16,700,000&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">tabdisp</span>(<span class="fu">sum</span>(y4B<span class="sc">$</span>inf[,,<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;16,900,000&quot;</code></pre>
<p>Output the total number of deaths</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y1<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y1<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;2,650,000&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y2<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y2<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;1,740,000&quot;</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y3<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y3<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;2,670&quot;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y4<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y4<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;446,000&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y4A<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y4A<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;807,000&quot;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">tabdisp</span>(y4B<span class="sc">$</span>sevIn<span class="sc">*</span><span class="fl">0.2</span> <span class="sc">+</span> y4B<span class="sc">$</span>sevOut)</span></code></pre></div>
<pre><code>## [1] &quot;834,000&quot;</code></pre>
<p>Plot cumulative deaths for different scenarios Plot</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4000</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">600</span><span class="sc">/</span><span class="dv">7</span>),</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Cum COVID-19 Deaths&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time&quot;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>y_scen1 <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(<span class="fl">0.2</span><span class="sc">*</span>y1<span class="sc">$</span>csevtreat[,,<span class="dv">1</span>])<span class="sc">+</span><span class="fu">rowSums</span>(y1<span class="sc">$</span>csevuntreat[,,<span class="dv">1</span>]))<span class="sc">/</span><span class="fu">sum</span>(pop)<span class="sc">*</span><span class="dv">100000</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="fu">points</span>(y1<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>y_scen2 <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(<span class="fl">0.2</span><span class="sc">*</span>y2<span class="sc">$</span>csevtreat[,,<span class="dv">1</span>])<span class="sc">+</span><span class="fu">rowSums</span>(y2<span class="sc">$</span>csevuntreat[,,<span class="dv">1</span>]))<span class="sc">/</span><span class="fu">sum</span>(pop)<span class="sc">*</span><span class="dv">100000</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="fu">points</span>(y2<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen2,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>y_scen4 <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(<span class="fl">0.2</span><span class="sc">*</span>y4<span class="sc">$</span>csevtreat[,,<span class="dv">1</span>])<span class="sc">+</span><span class="fu">rowSums</span>(y4<span class="sc">$</span>csevuntreat[,,<span class="dv">1</span>]))<span class="sc">/</span><span class="fu">sum</span>(pop)<span class="sc">*</span><span class="dv">100000</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen4,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>y_scen4a <span class="ot">&lt;-</span> (<span class="fu">rowSums</span>(<span class="fl">0.2</span><span class="sc">*</span>y4<span class="sc">$</span>csevtreat[,,<span class="dv">1</span>])<span class="sc">+</span><span class="fl">0.6</span><span class="sc">*</span><span class="fu">rowSums</span>(y4<span class="sc">$</span>csevuntreat[,,<span class="dv">1</span>]))<span class="sc">/</span><span class="fu">sum</span>(pop)<span class="sc">*</span><span class="dv">100000</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a><span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen4a,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtrZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///9sKxW+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJZ0lEQVR4nO2djVasNhRG0Tq22mqlIjq8/4OWEGBmHDhfkpNAgG+vdWuXk5uEfUNy8gNTNESkWLsCuUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCXAT9vL40VVE8fa1Ymwy5CCqfvr6fT015WrE2GTIK+nl9a+qi/fP4uWZ9suNGUNnKqSjohqtb7PTz+vT188pb7IbrTrp4+Di/088tHOYBFAS4CDq/Fx3spG+46qRpZoqrYf5lzXpky00cRO4ZBXGAn+bSB30/4yZ0wI7cCmqDxBHh4qui76fq4jAdlk8cdH4ftVSHWRW5dNJ/f3Q/hdn8VT9+nDn/nSBhNn/kFlRe+iChd6mKvgkdsQ8aWpDI0Jkfpv1wsgq5WQ86Wozjws2ifXUC4eJhA8XGTlbrtm+RxqdDB4omyPn+67P7M8ORh3l79WYkEwQdO1DsIsTyRWobDi2o2Az+gsyeajuSSU0DB4qbiRpCBDkAA8WjC1o6u3SECGqbx9NXGTR++93aOfQ2AYLqh4/KbD1LhmCg6FCuRweZEH9BZogyY5N0eAEHirjcLPSECDJBjhEkRDguwzwsLw8/ihZUzsdBDoEiFuRascQE90FjqDNBhBaUSwMKHcWK4kFaNtMHirn4yTZQ3LsgbXbZ+AkaxcSmEafcDQsqbfdSuayECauOuxVUD52ztOTqsEEtl5vNGOYt6Opoh3SQvB+8gltQPn58BV3NwMRz0uag8EEFuS6mlu29SEESbTdOQSLfz39QkMj5fX6+Jpab0SDmLwgO4BHKzchPnlMNCqIgXXYUREG67ChIzi6nUd5f0LDjpXxgQxSkyzouvoK+//zoz3cEhUFgG9OzTkvgvdzRzebNvrPuufm9CuqnGmDjUFnulgUNLegE1oNU5W5ZUFOZJVfTESmfm9+toKa2m4ba9wrsV9AC5VKQnF1WcWKWguKWpCSRIM0Js00LivbMqkpQ1JOJILj3bUHnd4fwR3c+CO1Ky/OU2ARMVvH4rjthBtbzF74D/fugGk/kk7WgxfWk6qRVJ8zmP1ojAEg0imlOmM1+tEqAFCbo6h6KX+7cR+sEkFsSpCwyjESCFIFiXg0okSBNoDjzyVoztCSCVMP8nCCpwIQkGcVUgeJMxL8dQQ7HgBO0oNVmsN6CnI4BawLFjQtyOgasChQnP1lvCcR7V8PpGLCm3G0Lcj0GPJsL3lmd+mTFVdiwjUODuHEYOVBccZExjaDYgeLeBGmG+am7ac19jiSCNIFiZg0ozaK9qgVpKpmA7FYUM7vD8ltRnBLkVXRksttZ3big9I8i3H+w7l59ohZUFf0xz7l420eQV8mxCR/mJarxBNHxBBUFnqTaYf78LrwjZq+C7CxLfC1Fc2ln5pWUakErHxcK6YNMM3Jbky5PvoLudazrJ7STruVBbNAy/7I8982vbQpqwHLHEErPnpZxFrT2gbzwFqR7e4e7IE0pEUjSBynK3b4gl1FMUe7WBbnFQYpyf/9+7S4oUSQdXu6doDjFhZPbbH4HguyGRao3UG1fUL9h4fQGqoByf/1+9S4o1dZzaLm/hazuR7P1HHKXoZ3V7O6wVDuroeVmd4flLkhRQiQWvsVQuZsXlLyTdkq1JJkN87e/zqALyi1QLFwSLUpeU42CguTsVrvD4j1x2I9j38/KFTMnQboinKoRdCJQSmjfQXr5GVwz/NuUDQiLGVM6Z2l/jNGP8juxXQRp8p8p1V2Mdy2GQDHSN4ctK8jfi38tlphq3FxAjDtMIWbMwi+h9py0XG60BhRBjHc1hj4o5VxM3YDCxER9scA4BUsxFytQgtncPMUUt4hJnevQ/6wTzsWufun5/VoeST1bWOhcTLs5NlWuux+3f/tQJ3OVipQwPLtC/riBYuIoma1UpITB2V1d0d3a/ew1J1Dyq4DoCYOzm/QzceXJnczUKlbCjoDHoS7Xav/vWsCyTm6rFT2hIeRxqOE3rYDew1pOJqsVL2ET9DBLcdNsVtdyIUAQ/r75+Rnbr4svJvGpf3JC4iA4x4jxJZC54C/I5YjQob/r2enVOIf+rufunduLlbs2IYKeUSftkt1m8Bbk8p5A70y1iZbNSP6b0c5xNjsVpH9/2USm2kQ5CYrTSf/OVJkoJ0HjY6uqTtqjOlsTFBMKipHp1gTxFnP7m7qN1ZlMgxNlKEj5iq79cScoShPaEXeCdHvz++O3IO1Xs+yOu1FMe851b2xmAWctKAgwCIp0ynV/9IJinXLdH72gWKdc94cVFO2U6/6wgqKdct0fg6BIp1z3x9AHRTrl2nRvkBFfAtIdoXnBKW1FpDRmo+oEMhpfS4eqNUcxlBXnlKt9drEWqnJ+bz+szIXJKesuppfS1G2CbmYkJDKvpeu+1glVa5YhDop0yrXv7oU1E/sv0N7Icsp25tNev5TGfiZnZKO79iNYrVmutn3MTEw9Ux2vX07W/mPKKaunf1tBUppxF0ZINApyrNYEsacattpwKCwfP8WU7YemD5LS1I//2TdCSYmGW8yxWhPEFmTvc3S3mxtaSmnuCCNISlOZ1XPTRMQi+77ZrVpTrCKoHvro2Ytv5UBBD32jkBKZb4c3E8x8BLm0ZTsgCCm7j9AtZjuUtnORMhq6nnxuMYfesB8phZRVvwP1JuVmr7a9ciHR2HDy6aTxeHp5F6OcsgTDvJ0e1eIwb73IaQDRF8xQRHZZcgIpSxQoVoNBIdHQB+kDxXhUckzf3z4miZzSTjWkNPUwZxESlQ5pRLjkCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBshN0efr6v4hvEwknO0GGiG/JUENBgIwFmRNS38//mKOs5kx9d0Ss0H/TqSfZC+rO5T9+dsfnzLnNpZ/5y17QSzP8580+crPw40jZC3prxv/YI3Tqp0n82JSg4fDrknXZlKAI37XszZYExXwPnTNbEmSfPiiXbUebEtTFQQs/MpqloJygIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wOVmOtNk/ofJQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Output the proportion of herd immunity acheived at 18 months</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y1<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 161</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y2<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 106</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y3<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y4<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y4A<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(y4B<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">sum</span>(pop)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 51</code></pre>
<p>Work to load up excess mortality data. This will go futher up in the
final version of this</p>
<p>These bits need to be coded as a data object</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="cf">if</span> (<span class="cn">FALSE</span>) {</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="do">## tmpdir &lt;- &quot;C:/tmp/&quot;</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  localfn <span class="ot">&lt;-</span> <span class="fu">paste0</span>(tmpdir,<span class="st">&quot;excess_death.csv&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  localfn_w <span class="ot">&lt;-</span> <span class="fu">paste0</span>(tmpdir,<span class="st">&quot;excess_death_econ.csv&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  <span class="do">## webfn &lt;- &quot;https://raw.githubusercontent.com/owid/covid-19-data/4132d2c726fa406d5ff934b4f6411f463992a07d/public/data/excess_mortality/excess_mortality.csv&quot;</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  <span class="do">## x &lt;- read.csv(webfn)</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  <span class="do">## write.csv(x,file=localfn,row.names = FALSE)</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  <span class="do">## wwebfn &lt;- &quot;https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/excess_mortality/excess_mortality_economist_estimates.csv&quot;</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  <span class="do">## w &lt;- read.csv(wwebfn)</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  <span class="do">## write.csv(w,file=localfn_w,row.names=FALSE)</span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  </span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(localfn)</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(localfn_w)</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>  <span class="fu">names</span>(z)</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  <span class="fu">dim</span>(z)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>  </span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">table</span>(z<span class="sc">$</span>country))</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  </span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>  <span class="do">## all(dim(x) == dim(y))</span></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>  <span class="do">## all(names(x) == names(y))</span></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>  df <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(time_unit<span class="sc">==</span><span class="st">&quot;weekly&quot;</span>, date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2021-08-31&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;location&quot;</span>, <span class="st">&quot;cum_excess_per_million_proj_all_ages&quot;</span>,<span class="st">&quot;date&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;cumexcess&quot;</span> <span class="ot">=</span> <span class="st">&quot;cum_excess_per_million_proj_all_ages&quot;</span>,</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>                  <span class="st">&quot;country&quot;</span><span class="ot">=</span><span class="st">&quot;location&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">spread</span>(country,cumexcess)</span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a>  <span class="fu">dim</span>(df)</span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>  <span class="fu">names</span>(df)</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>  </span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> z <span class="sc">%&gt;%</span></span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2021-08-31&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;date&quot;</span>,<span class="st">&quot;country&quot;</span>,</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>                  <span class="st">&quot;cumulative_estimated_daily_excess_deaths_per_100k&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;cumexcess&quot;</span> <span class="ot">=</span></span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a>                    <span class="st">&quot;cumulative_estimated_daily_excess_deaths_per_100k&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">spread</span>(country,cumexcess)</span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>  </span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>  <span class="fu">dim</span>(df2)</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>  colnames <span class="ot">&lt;-</span> <span class="fu">names</span>(df2)</span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>  windex <span class="ot">&lt;-</span> <span class="fu">which</span>(colnames<span class="sc">==</span><span class="st">&quot;World&quot;</span>)</span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>  dindex <span class="ot">&lt;-</span> <span class="fu">which</span>(colnames<span class="sc">==</span><span class="st">&quot;date&quot;</span>)</span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>  countries <span class="ot">&lt;-</span> colnames[<span class="sc">-</span><span class="fu">c</span>(windex,dindex)]</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>  ncountries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a>  </span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a>  plot_cum <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">ymin=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">ymax=</span><span class="dv">4000</span>, <span class="at">weekmax=</span><span class="dv">75</span>,<span class="at">incmodels=</span><span class="cn">TRUE</span>) {</span>
<span id="cb53-46"><a href="#cb53-46" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(ymin,ymax),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,weekmax),</span>
<span id="cb53-47"><a href="#cb53-47" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Excess mortality per 100k&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Week 2020&quot;</span>)</span>
<span id="cb53-48"><a href="#cb53-48" tabindex="-1"></a>    <span class="cf">for</span> (c <span class="cf">in</span> countries) {</span>
<span id="cb53-49"><a href="#cb53-49" tabindex="-1"></a>      <span class="fu">points</span>(df2[<span class="dv">1</span><span class="sc">:</span>weekmax,c],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb53-50"><a href="#cb53-50" tabindex="-1"></a>    }</span>
<span id="cb53-51"><a href="#cb53-51" tabindex="-1"></a>    <span class="fu">points</span>(df2<span class="sc">$</span><span class="st">`</span><span class="at">United Kingdom</span><span class="st">`</span>[<span class="dv">1</span><span class="sc">:</span>weekmax],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-52"><a href="#cb53-52" tabindex="-1"></a>    <span class="fu">points</span>(df2<span class="sc">$</span>Australia[<span class="dv">1</span><span class="sc">:</span>weekmax],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-53"><a href="#cb53-53" tabindex="-1"></a>    <span class="fu">points</span>(df2<span class="sc">$</span>China[<span class="dv">1</span><span class="sc">:</span>weekmax],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-54"><a href="#cb53-54" tabindex="-1"></a>    <span class="fu">points</span>(df2<span class="sc">$</span><span class="st">`</span><span class="at">United States</span><span class="st">`</span>[<span class="dv">1</span><span class="sc">:</span>weekmax],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;cyan&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-55"><a href="#cb53-55" tabindex="-1"></a>    <span class="fu">points</span>(df2<span class="sc">$</span>Norway[<span class="dv">1</span><span class="sc">:</span>weekmax],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-56"><a href="#cb53-56" tabindex="-1"></a>    <span class="do">## points(df2$Taiwan[1:weekmax],type=&quot;l&quot;,col=&quot;orange&quot;,lwd=3)</span></span>
<span id="cb53-57"><a href="#cb53-57" tabindex="-1"></a>    <span class="cf">if</span> (incmodels) {</span>
<span id="cb53-58"><a href="#cb53-58" tabindex="-1"></a>      <span class="fu">points</span>(y1<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-59"><a href="#cb53-59" tabindex="-1"></a>      <span class="fu">points</span>(y2<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen2,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-60"><a href="#cb53-60" tabindex="-1"></a>      <span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen4,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-61"><a href="#cb53-61" tabindex="-1"></a>      <span class="fu">points</span>(y4<span class="sc">$</span>t<span class="sc">/</span><span class="dv">7</span>,y_scen4a,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb53-62"><a href="#cb53-62" tabindex="-1"></a>    }</span>
<span id="cb53-63"><a href="#cb53-63" tabindex="-1"></a>    </span>
<span id="cb53-64"><a href="#cb53-64" tabindex="-1"></a>  }</span>
<span id="cb53-65"><a href="#cb53-65" tabindex="-1"></a>  </span>
<span id="cb53-66"><a href="#cb53-66" tabindex="-1"></a>  <span class="do">## pdf_fig_proof(file=paste0(tmpdir,&quot;plot1.pdf&quot;))</span></span>
<span id="cb53-67"><a href="#cb53-67" tabindex="-1"></a>  <span class="fu">plot_cum</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">76</span>,<span class="cn">FALSE</span>)</span>
<span id="cb53-68"><a href="#cb53-68" tabindex="-1"></a>  <span class="do">## dev.off()</span></span>
<span id="cb53-69"><a href="#cb53-69" tabindex="-1"></a>  </span>
<span id="cb53-70"><a href="#cb53-70" tabindex="-1"></a>  <span class="do">## pdf_fig_proof(file=paste0(tmpdir,&quot;plot2.pdf&quot;))</span></span>
<span id="cb53-71"><a href="#cb53-71" tabindex="-1"></a>  <span class="fu">plot_cum</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">4000</span>,<span class="dv">76</span>,<span class="cn">TRUE</span>)</span>
<span id="cb53-72"><a href="#cb53-72" tabindex="-1"></a>  <span class="do">## dev.off()</span></span>
<span id="cb53-73"><a href="#cb53-73" tabindex="-1"></a>  </span>
<span id="cb53-74"><a href="#cb53-74" tabindex="-1"></a>  <span class="fu">plot_cum</span>(<span class="dv">600</span>)</span>
<span id="cb53-75"><a href="#cb53-75" tabindex="-1"></a>  </span>
<span id="cb53-76"><a href="#cb53-76" tabindex="-1"></a>  </span>
<span id="cb53-77"><a href="#cb53-77" tabindex="-1"></a>  <span class="co">#&#39; Load a database of social mixing patterns</span></span>
<span id="cb53-78"><a href="#cb53-78" tabindex="-1"></a>  <span class="fu">library</span>(socialmixr)</span>
<span id="cb53-79"><a href="#cb53-79" tabindex="-1"></a>  <span class="fu">library</span>(devtools)</span>
<span id="cb53-80"><a href="#cb53-80" tabindex="-1"></a>  <span class="fu">load_all</span>()</span>
<span id="cb53-81"><a href="#cb53-81" tabindex="-1"></a>  <span class="fu">data</span>(polymod)</span>
<span id="cb53-82"><a href="#cb53-82" tabindex="-1"></a>  age_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">11</span>,<span class="dv">18</span>,<span class="dv">30</span>)</span>
<span id="cb53-83"><a href="#cb53-83" tabindex="-1"></a>  nACs <span class="ot">&lt;-</span> <span class="fu">length</span>(age_bounds)</span>
<span id="cb53-84"><a href="#cb53-84" tabindex="-1"></a>  mixr_polyuk <span class="ot">&lt;-</span> <span class="fu">contact_matrix</span>(</span>
<span id="cb53-85"><a href="#cb53-85" tabindex="-1"></a>    polymod,</span>
<span id="cb53-86"><a href="#cb53-86" tabindex="-1"></a>    <span class="at">countries=</span><span class="st">&quot;Great Britain&quot;</span>,</span>
<span id="cb53-87"><a href="#cb53-87" tabindex="-1"></a>    <span class="at">age.limits =</span> age_bounds,</span>
<span id="cb53-88"><a href="#cb53-88" tabindex="-1"></a>    <span class="at">symmetric=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-89"><a href="#cb53-89" tabindex="-1"></a></span>
<span id="cb53-90"><a href="#cb53-90" tabindex="-1"></a>  <span class="co">#&#39; Extract basic contact matrices</span></span>
<span id="cb53-91"><a href="#cb53-91" tabindex="-1"></a>  matpolyuk <span class="ot">&lt;-</span> mixr_polyuk<span class="sc">$</span>matrix</span>
<span id="cb53-92"><a href="#cb53-92" tabindex="-1"></a>  poppolyuk <span class="ot">&lt;-</span> mixr_polyuk<span class="sc">$</span>demography<span class="sc">$</span>population</span>
<span id="cb53-93"><a href="#cb53-93" tabindex="-1"></a></span>
<span id="cb53-94"><a href="#cb53-94" tabindex="-1"></a>  <span class="co">#&#39; ## Define susceptibiity profiles and school closure mixing</span></span>
<span id="cb53-95"><a href="#cb53-95" tabindex="-1"></a>  <span class="co">#&#39;</span></span>
<span id="cb53-96"><a href="#cb53-96" tabindex="-1"></a>  <span class="co">#&#39; Establish some baseline values for susceptibility</span></span>
<span id="cb53-97"><a href="#cb53-97" tabindex="-1"></a>  susBase <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,nACs)</span>
<span id="cb53-98"><a href="#cb53-98" tabindex="-1"></a>  susLowKids <span class="ot">&lt;-</span> susBase</span>
<span id="cb53-99"><a href="#cb53-99" tabindex="-1"></a>  susLowKids[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fl">0.333</span></span>
<span id="cb53-100"><a href="#cb53-100" tabindex="-1"></a></span>
<span id="cb53-101"><a href="#cb53-101" tabindex="-1"></a>  <span class="co">#&#39; Run two test cases for the R0 parameterization</span></span>
<span id="cb53-102"><a href="#cb53-102" tabindex="-1"></a>  yA <span class="ot">&lt;-</span> <span class="fu">cov_hybrid</span>(</span>
<span id="cb53-103"><a href="#cb53-103" tabindex="-1"></a>    <span class="at">vecN=</span>poppolyuk,</span>
<span id="cb53-104"><a href="#cb53-104" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">1.01</span>,</span>
<span id="cb53-105"><a href="#cb53-105" tabindex="-1"></a>    <span class="at">matCt=</span>matpolyuk,</span>
<span id="cb53-106"><a href="#cb53-106" tabindex="-1"></a>    <span class="at">vecTcal=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.001</span>),</span>
<span id="cb53-107"><a href="#cb53-107" tabindex="-1"></a>    <span class="at">vecInfNess=</span><span class="fu">rep</span>(<span class="dv">1</span>,nACs),</span>
<span id="cb53-108"><a href="#cb53-108" tabindex="-1"></a>    <span class="at">vecSusTy=</span>susLowKids,</span>
<span id="cb53-109"><a href="#cb53-109" tabindex="-1"></a>    <span class="at">deterministic=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-110"><a href="#cb53-110" tabindex="-1"></a>  yB <span class="ot">&lt;-</span> <span class="fu">cov_hybrid</span>(</span>
<span id="cb53-111"><a href="#cb53-111" tabindex="-1"></a>    <span class="at">vecN=</span>poppolyuk,</span>
<span id="cb53-112"><a href="#cb53-112" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">0.99</span>,</span>
<span id="cb53-113"><a href="#cb53-113" tabindex="-1"></a>    <span class="at">matCt=</span>matpolyuk,</span>
<span id="cb53-114"><a href="#cb53-114" tabindex="-1"></a>    <span class="at">vecTcal=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.001</span>),</span>
<span id="cb53-115"><a href="#cb53-115" tabindex="-1"></a>    <span class="at">vecInfNess=</span><span class="fu">rep</span>(<span class="dv">1</span>,nACs),</span>
<span id="cb53-116"><a href="#cb53-116" tabindex="-1"></a>    <span class="at">vecSusTy=</span>susLowKids,</span>
<span id="cb53-117"><a href="#cb53-117" tabindex="-1"></a>    <span class="at">deterministic=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-118"><a href="#cb53-118" tabindex="-1"></a></span>
<span id="cb53-119"><a href="#cb53-119" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">rowSums</span>(yA<span class="sc">$</span>inf[,,<span class="dv">1</span>]),<span class="at">log=</span><span class="st">&quot;y&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>))</span>
<span id="cb53-120"><a href="#cb53-120" tabindex="-1"></a>  <span class="fu">points</span>(<span class="fu">rowSums</span>(yB<span class="sc">$</span>inf[,,<span class="dv">1</span>]),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb53-121"><a href="#cb53-121" tabindex="-1"></a></span>
<span id="cb53-122"><a href="#cb53-122" tabindex="-1"></a>  <span class="co">#&#39; Check to see if attack rates are about right with uniform mixing and</span></span>
<span id="cb53-123"><a href="#cb53-123" tabindex="-1"></a>  <span class="co">#&#39; uniform susceptibility and a perfectly balanced population. Seems to be OK</span></span>
<span id="cb53-124"><a href="#cb53-124" tabindex="-1"></a>  <span class="co">#&#39; to within half a percent.</span></span>
<span id="cb53-125"><a href="#cb53-125" tabindex="-1"></a>  yC <span class="ot">&lt;-</span> <span class="fu">cov_hybrid</span>(</span>
<span id="cb53-126"><a href="#cb53-126" tabindex="-1"></a>    <span class="at">R0=</span><span class="fl">1.8</span>)</span>
<span id="cb53-127"><a href="#cb53-127" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sum</span>(yC<span class="sc">$</span>inf[,,<span class="dv">1</span>])<span class="sc">/</span><span class="fu">sum</span>(yC<span class="sc">$</span>pop)</span>
<span id="cb53-128"><a href="#cb53-128" tabindex="-1"></a>  epsilon <span class="ot">&lt;-</span> (a <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.8</span><span class="sc">*</span>a) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>a</span>
<span id="cb53-129"><a href="#cb53-129" tabindex="-1"></a>  epsilon</span>
<span id="cb53-130"><a href="#cb53-130" tabindex="-1"></a>}</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
